<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>필터페이지</title>
    <link rel="stylesheet" href="./project_header.css">
    <link rel="stylesheet" href="./project_footer.css">
    <link rel="stylesheet" href="./slider.css">
    <script async src="./slider.js"></script>
    <style>
        @font-face 
        {
        font-family: 'CBNUJIKJI';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2202@1.0/CBNUJIKJI.woff') format('woff');
        font-weight: normal;
        font-style: normal;
        }
        body
        {
            margin: 0;
            background-color: #222;
            font-family: 'CBNUJIKJI';
            font-size: 13px;
        }

        .options,
        .result_options
        {
            cursor: pointer;
        }
        ul
        {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        li
        {
            margin: 0;
            padding: 0;
        }
        .checkbox_flip
        {
            display: none;
        }
        .wrap
        {
            width: 1100px;
            /* max-width: 1100px; */
            margin: 0 auto;
            color: #fff;
            /* background-color: #444; */
            position: relative;
        }

        .contents_area
        {
            width: 100%;
            /* border: 1px solid; */
            box-sizing: border-box;
            margin-top: 80px;
            /* position: absolute;
            top: 80px; */
            display: flex;
            padding: 20px 0;
        }
        .article
        {
            width: 70%;
            /* border: 1px solid; */
            box-sizing: border-box;
            padding-right: 10px;
        }
        .filter_box
        {
            width: 100%;
            padding-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .filter_ul
        {
            width: 100%;
            height: 60px;
            line-height: 60px;
            display: flex;
            /* margin-bottom: 5px; */
            gap: 10px;
            /* border: 1px solid; */
            box-sizing: border-box;
            position: relative;
        }
        .options_li
        {
            width: calc(100% - 110px);
            display: flex;
            /* justify-content: space-between; */
            gap: 10px;
        }
        .options
        {
            /* width: 110px; */
            text-align: center;
            flex-grow: 1;
            /* border-right: 1px solid; */
            /* padding: 0 30px; */
            /* box-sizing: border-box; */
            background-color: rgba(0, 0, 0, 0.4);
        }
        .checked
        {
            background-color: rgba(255, 105, 180, 0.1);
        }
        .filter_name
        {
            width: 80px;
            padding-left: 10px;
            /* border: 1px solid; */
            box-sizing: border-box;
            color: hotpink;
            background-color: rgba(255, 105, 180, 0.1);
        }
        .label_flip
        {
            width: 30px;
            height: 58px;
            text-align: center;
            background-color: #333;
            /* position: absolute;
            top: 0;
            right: 0; */
            opacity: 0.9;
        }
        .label_flip:hover
        {
            cursor: pointer;
        }
        .transparent
        {
            width: 30px;
            height: 58px;
            background-color: transparent;
        }
        .hided_filter
        {
            display: none;
        }
        .checkbox_flip:checked + .hided_filter
        {
            display: inline-flex;
            /* justify-content: space-between; */
            align-items: center;
        }
        .result_options_bar
        {
            height: 50px;
            line-height: 50px;
            padding: 5px;
            background-color: rgba(255, 105, 180, 0.1);
        }
        .result_options
        {
            height: 50px;
            line-height: 32px;
            background-color: rgba(0, 0, 0, 0.4);
            padding: 10px;
            margin: 0 10px;
            /* border: 1px solid; */
            box-sizing: border-box;
            display: inline-block;
        }
        .result_options_tmp_phrase
        {
            text-align: center;
            font-size: 20px;
            animation: phrase 1s infinite, color 1s infinite;
        }
        @keyframes phrase
        {
            0%{transform: translateY(0%);}
            55%{transform: translateY(10%);}
            65%{transform: translateY(-10%);}
            80%{transform: translateY(0%);}
            85%{transform: translateY(-5%);}
            90%{transform: translateY(0%);}
            95%{transform: translateY(-2%);}
            100%{transform: translateY(0%);}
        }
        @keyframes color
        {
            0%{color: white;}
            55%{color: hotpink;}
            100%{color: white;}
        }
        .filter_footer
        {
            width: 100%;
            height: 80px;
            line-height: 80px;
            text-align: center;
            /* border-top: 1px solid; */
            box-sizing: border-box;
            display: flex;
        }
        .hide_mine
        {
            width: 25%;
            /* border-right: 1px solid; */
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .hide_mine_check_box
        {
            width: 13px;
            height: 13px;
            margin: 0 5px;
            display: inline-block;
            border: 3px solid hotpink;
            position: relative;
        }
        .hide_mine_check
        {
            width: 25px;
            position: absolute;
            top: -70%;
            left: -35%;
            display: none;
        }
        .display
        {
            display: inline-block;
        }
        .show_all
        {
            width: 75%;
            font-size: 30px;
        }
        .aside
        {
            width: 30%;
            border-left: 1px solid rgba(255, 105, 180, 0.1);
;
            padding-left: 10px;
            box-sizing: border-box;
            overflow-y: scroll;
        }
        .aside::-webkit-scrollbar
        {
            width: 10px;
        }
        .aside::-webkit-scrollbar-thumb {
            background-color: #555;
        }
        .aside::-webkit-scrollbar-track {
            background-color: transparent;
        }
        .aside::-webkit-scrollbar-corner {
            background-color: transparent;
        }
        .thumbnail
        {
            width: 50%;
            height: 200px;
            float: left;
            border: 1px solid #222;
            box-sizing: border-box;
            background: url(./썸네일.jpg) center / cover;
        }
    </style>
</head>
<body onselectstart="return false">
    <div class="wrap">
        <div class="header">
            <div class="logo">FILMAP</div>
            <div class="menu_box">
                <div class="menu">홈</div>
                <div class="menu">검색</div>
                <div class="menu">예고편</div>
            </div>
            <div class="search_box">
                <input type="text" name="" class="search_bar">
                <div class="search_btn"></div>
                <div class="search_page"></div>
            </div>
            <div class="sign_box">
                <div class="sign">로그인</div>
                <div class="sign">회원가입</div>
            </div>
        </div>
        <div class="contents_area">
            <div class="article">
                <div class="filter_box">
                    <ul class="filter_ul">
                        <li class="filter_name">장르</li>
                        <li class="options_li">
                            <div class="options">액션</div>
                            <div class="options">코미디</div>
                            <div class="options">로맨스</div>
                            <div class="options">공포</div>
                            <div class="options">다큐</div>
                        </li>
                        <label for="checkbox_flip1" class="label_flip">▾</label>
                    </ul>
                    <input type="checkbox" name="" class="checkbox_flip" id="checkbox_flip1">
                    <ul class="filter_ul hided_filter">
                        <li class="filter_name"></li>
                        <li class="options_li">
                            <div class="options">판타지</div>
                            <div class="options">SF</div>
                            <div class="options">범죄</div>
                            <div class="options">스릴러</div>
                            <div class="options">학원</div>
                        </li>
                        <div class="transparent"></div>
                    </ul>
                    <ul class="filter_ul">
                        <li class="filter_name">국가</li>
                        <li class="options_li">
                            <div  class="options">한국</div>
                            <div  class="options">미국</div>
                            <div  class="options">일본</div>
                            <div  class="options">영국</div>
                        </li>
                        <label for="checkbox_flip2" class="label_flip">▾</label>
                    </ul>
                    <input type="checkbox" name="" class="checkbox_flip" id="checkbox_flip2">
                    <ul class="filter_ul hided_filter">
                        <li class="filter_name"></li>
                        <li class="options_li">
                            <div class="options">대만</div>
                            <div class="options">프랑스</div>
                            <div class="options">러시아</div>
                            <div class="options">남아공</div>
                        </li>
                        <div class="transparent"></div>
                    </ul>
                    <ul class="filter_ul">
                        <li class="filter_name">등급</li>
                        <li class="options_li">
                            <div class="options">전체이용가</div>
                            <div class="options">12세 관람가</div>
                            <div class="options">15세 관람가</div>
                            <div class="options">청소년 관람불가</div>
                        </li>
                        <div class="transparent"></div>
                    </ul>
                    <ul class="filter_ul">
                        <li class="filter_name">길이</li>
                        <li class="options_li">
                            <div class="options">~ 90분</div>
                            <div class="options">90분 ~ 120분</div>
                            <div class="options">120분 ~</div>
                            <div class="slider">
                                <input type="range" class="input_left" min="1" max="100" value="1" />
                                <input type="range" class="input_right" min="1" max="100" value="100" />
                                <div class="track">
                                <div class="selected_area"></div>
                                <div class="thumb left"></div>
                                <div class="thumb right"></div>
                                </div>
                            </div>
                        </li>
                        <div class="transparent"></div>
                    </ul>
                    <input type="checkbox" name="" class="checkbox_flip" id="checkbox_flip4">
                    <ul class="filter_ul hided_filter">
                        <li class="filter_name"></li>
                        <li class="options_li">
                            <div class="options"></div>
                            <div class="options"></div>
                            <div class="options"></div>
                            <div class="options"></div>
                        </li>
                    </ul>
                    <ul class="filter_ul">
                        <li class="filter_name">개봉년도</li>
                        <li class="options_li">
                            <div class="options">2020</div>
                            <div class="options">2010</div>
                            <div class="options">2000</div>
                            <div class="options">~1990</div>
                            <div class="slider">
                                <input type="range" class="input_left" min="1" max="100" value="1" />
                                <input type="range" class="input_right" min="1" max="100" value="100" />
                                <div class="track">
                                <div class="selected_area"></div>
                                <div class="thumb left"></div>
                                <div class="thumb right"></div>
                                </div>
                            </div>
                        </li>
                        <div class="transparent"></div>
                    </ul>
                    <input type="checkbox" name="" class="checkbox_flip" id="checkbox_flip3">
                    <ul class="filter_ul hided_filter">
                        <li class="filter_name"></li>
                        <li class="options_li">
                        </li>
                        <div class="transparent"></div>
                    </ul>
                </div>
                <div class="result_options_bar">
                    <div class="result_options_tmp_phrase">취향에 따라 골라보세요!</div>
                </div>
                <div class="filter_footer">
                    <div class="hide_mine">
                        내가 본 영화 숨기기
                        <div class="hide_mine_check_box">
                            <img class="hide_mine_check" src="./check.png" alt="check">
                        </div>
                    </div>
                    <div class="show_all">
                        <span class="filtered_qtt">100</span>
                        개의 영화 모두보기
                    </div>
                </div>
            </div>
            <div class="aside">
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
                <div class="thumbnail"></div>
            </div>
        </div>
    </div>
    <div class="footer">footer</div>
    <script>
        let opt = document.getElementsByClassName("options");
        let rOpt = document.getElementsByClassName("result_options");
        let rOptBar = document.getElementsByClassName("result_options_bar");
        function putHeight1()//article 높이에 따라 aside 높이 바꾸기
        {
            document.getElementsByClassName("aside")[0].setAttribute("style", "height:" + (document.getElementsByClassName("filter_box")[0].clientHeight + rOptBar[0].clientHeight + document.getElementsByClassName("filter_footer")[0].clientHeight + 4) + "px");
            console.log((document.getElementsByClassName("filter_box")[0].clientHeight + rOptBar[0].clientHeight + document.getElementsByClassName("filter_footer")[0].clientHeight));
            console.log(document.getElementsByClassName("aside")[0].getAttribute("style"));
        }
        putHeight1();//aside 높이 초기 설정
        function putHeight2()//article 높이 구해온 후 적용해야 하기에 지연
        {
            setTimeout(function()
            {
                putHeight1()
            }, 10);
        }
        for (let i = 0; i < 2; i++)//옵션 더보기 버튼 눌리면 aside 높이 변경
        {
            document.getElementsByClassName("label_flip")[i].addEventListener("click", function(){putHeight2();});
        }

        function tmp_qtt(n)//db 연결 전 임시 최종 수량
        {
            document.getElementsByClassName("filtered_qtt")[0].innerText -= n;
        }

        function phrase(n)//입맛에 따라 골라보세요 문구
        {
            setTimeout(function(){
                if (n == 1)
                {
                    if (rOptBar[0].innerHTML.match("span") == null)
                    {
                        document.getElementsByClassName("result_options_tmp_phrase")[0].style.display = "block";
                    }
                }
                else if (n == 0)
                {
                    document.getElementsByClassName("result_options_tmp_phrase")[0].style.display = "none";
                }
            }, 20)
        }
        ///체크된 옵션 표시/해제, 밑에 한번에 보여주는 기능
        for (let i = 0; i < opt.length; i++)
        {
            opt[i].addEventListener("click", function(){//모든 옵션에 버튼 달기
                let rOptLength = 0;//result options 총 길이, 옵션 클릭마다 초기화하고 다시 구함
                opt[i].classList.toggle("checked");//눌리면 회색, 풀리면 원래대로
                setTimeout(function(){
                    if (opt[i].classList.contains("checked"))
                    {
                        let newResult = document.createElement("span");//체크된 옵션 보여주는 result span 만들어서 맨밑에 요소 넣기
                        newResult.setAttribute("class", "result_options");
                        newResult.setAttribute("id", "result" + i);
                        newResult.innerText = opt[i].innerText;
                        newResult.addEventListener("click", function(){//result span에 누르면 해제되는 기능 넣기
                            opt[i].classList.toggle("checked");
                            newResult.remove();
                            tmp_qtt(-5);
                            phrase(1);
                        })

                        rOptBar[0].appendChild(newResult);
                        phrase(0);
                        
                        tmp_qtt(5);//임시값
                    }
                    else
                    {
                        document.getElementById("result" + i).remove();
                        phrase(1);
                        tmp_qtt(-5);
                    }
                }, 0)
                setTimeout(function(){
                            for (let j = 0; j < rOpt.length; j++)
                            {
                                rOptLength += rOpt[j].offsetWidth + 20;
                            }
                            console.log(rOptLength);
                            console.log(rOptBar[0].offsetWidth);
                            if (rOptBar[0].offsetWidth <= rOptLength)
                            {
                                // console.log("넘엇다");
                                rOptBar[0].style.height = "100px";
                            }
                            else
                            {
                                // console.log("안넘엇다");
                                rOptBar[0].style.height = "50px";
                            }
                            putHeight2();//리절트 바가 커지면 aside도 같이 커짐
                        },1)
            })
        }
        document.getElementsByClassName("hide_mine_check_box")[0].addEventListener("click", function(){
            document.getElementsByClassName("hide_mine_check")[0].classList.toggle("display");
        })
        document.getElementsByClassName("search_bar")[0].addEventListener("focus", function(){
            document.getElementsByClassName("hide_mine_check")[0].classList.toggle("display");
        })
        document.getElementsByClassName("search_bar")[0].addEventListener("blur", function(){
            document.getElementsByClassName("hide_mine_check")[0].classList.toggle("display");
        })
    </script>
</body>
</html>